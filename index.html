<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Secret Agent Digital Marketing - Stealth Strategies. Real Results.</title>
    <meta name="description" content="Elite digital marketing agency delivering ROI-driven campaigns for small businesses. Custom strategies, transparent reporting, and proven results." />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Orbitron:wght@400;500;700;800;900&display=swap" rel="stylesheet">

    <!-- NEW GOOGLE TAG (gtag.js) - UPDATED VERSION -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CTDQQ8XMKC"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CTDQQ8XMKC');
      
      // Enhanced initialization logging
      console.log('‚úÖ NEW Google Analytics 4 (gtag.js) loaded');
      console.log('üìä Measurement ID: G-CTDQQ8XMKC');
      console.log('üéØ DataLayer initialized with gtag function');
    </script>

    <!-- GOOGLE ANALYTICS VERIFICATION SCRIPT -->
    <script>
      // Comprehensive GA4 verification function
      window.verifyGA4Implementation = function() {
        console.log('üß™ VERIFYING NEW GOOGLE ANALYTICS 4 IMPLEMENTATION');
        console.log('=================================================');
        
        const results = {
          gtagFunction: typeof window.gtag === 'function',
          dataLayer: window.dataLayer && Array.isArray(window.dataLayer),
          scriptTag: !!document.querySelector('script[src*="googletagmanager.com/gtag/js?id=G-CTDQQ8XMKC"]'),
          measurementId: 'G-CTDQQ8XMKC'
        };
        
        console.log('üìä Test Results:');
        console.log('  ‚úÖ gtag function:', results.gtagFunction ? 'AVAILABLE' : '‚ùå MISSING');
        console.log('  ‚úÖ dataLayer:', results.dataLayer ? `ACTIVE (${window.dataLayer.length} entries)` : '‚ùå MISSING');
        console.log('  ‚úÖ Script tag:', results.scriptTag ? 'LOADED' : '‚ùå MISSING');
        console.log('  ‚úÖ Measurement ID:', results.measurementId);
        
        // Test event firing
        try {
          gtag('event', 'ga4_verification_test', {
            event_category: 'testing',
            event_label: 'new_gtag_implementation',
            custom_parameter: 'verification_successful',
            timestamp: new Date().toISOString()
          });
          console.log('  ‚úÖ Test event fired successfully');
          results.eventFiring = true;
        } catch (error) {
          console.log('  ‚ùå Test event failed:', error.message);
          results.eventFiring = false;
        }
        
        const allPassed = Object.values(results).every(val => val === true || typeof val === 'string');
        console.log('\nüéØ Overall Status:', allPassed ? '‚úÖ FULLY OPERATIONAL' : '‚ö†Ô∏è ISSUES DETECTED');
        
        if (allPassed) {
          console.log('üéâ NEW Google Analytics 4 is working perfectly!');
          console.log('üìä Data is being sent to GA4 dashboard');
          console.log('üöÄ Ready for production tracking');
        }
        
        return results;
      };

      // Auto-verify after page load
      window.addEventListener('load', () => {
        setTimeout(() => {
          console.log('üîç Auto-running GA4 verification...');
          window.verifyGA4Implementation();
        }, 2000);
      });
    </script>

    <!-- Firebase Analytics (Alternative/Backup) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    <script>
      // Firebase config (as backup to gtag)
      const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "YOUR_APP_ID",
        measurementId: "G-CTDQQ8XMKC"
      };

      try {
        const app = firebase.initializeApp(firebaseConfig);
        const analytics = firebase.analytics();
        window.firebaseAnalytics = analytics;
        console.log('üî• Firebase Analytics initialized as backup');
      } catch (error) {
        console.log('Firebase initialization skipped (gtag is primary):', error.message);
      }
    </script>

    <!-- CyborgCRM Tracking Code -->
    <script>
      (function(c,y,b,o,r,g) {
        c.CyborgCRM = c.CyborgCRM || function() {
          (c.CyborgCRM.q = c.CyborgCRM.q || []).push(arguments)
        };
        c.CyborgCRM.l = 1 * new Date();
        g = y.createElement(b);
        o = y.getElementsByTagName(b)[0];
        g.async = 1;
        g.src = r;
        o.parentNode.insertBefore(g, o)
      })(window, document, 'script', 'https://cdn.cyborgcrm.com/tracking.js');

      try {
        CyborgCRM('init', 'YOUR_WEBSITE_ID');
        CyborgCRM('track', 'pageview');
        console.log('ü§ñ CyborgCRM initialized');
      } catch (error) {
        console.log('CyborgCRM initialization error:', error);
      }
    </script>

    <!-- SITEBEHAVIOUR TRACKING - UPDATED VERSION -->
    <script type="text/javascript">
      (function() {
        var sbSiteSecret = '507f5743-d0f0-49db-a5f0-0d702b989128';
        window.sitebehaviourTrackingSecret = sbSiteSecret;
        var scriptElement = document.createElement('script');
        scriptElement.defer = true;
        scriptElement.id = 'site-behaviour-script-v2';
        scriptElement.src = 'https://sitebehaviour-cdn.fra1.cdn.digitaloceanspaces.com/index.min.js?sitebehaviour-secret=' + sbSiteSecret;
        
        scriptElement.onload = function() {
          console.log('‚úÖ SiteBehaviour script loaded successfully');
          console.log('üéØ Secret configured:', sbSiteSecret.substring(0, 8) + '...');
          
          // Test data transmission immediately
          testSiteBehaviourConnection();
        };
        
        scriptElement.onerror = function() {
          console.error('‚ùå CRITICAL: SiteBehaviour script failed to load');
        };
        
        document.head.appendChild(scriptElement);
        console.log('üöÄ SiteBehaviour tracking code initiated');
      })();
    </script>

    <!-- COMPREHENSIVE ANALYTICS TEST FUNCTION -->
    <script>
      // Test all analytics platforms together
      window.testAllAnalytics = function() {
        console.log('üß™ TESTING ALL ANALYTICS PLATFORMS');
        console.log('==================================');
        
        const results = {
          ga4: false,
          sitebehaviour: false,
          firebase: false,
          cyborgcrm: false
        };
        
        // Test GA4 (Primary)
        try {
          if (typeof window.gtag === 'function') {
            gtag('event', 'all_analytics_test', {
              event_category: 'testing',
              event_label: 'comprehensive_test',
              platform: 'ga4'
            });
            results.ga4 = true;
            console.log('‚úÖ GA4: Test event sent successfully');
          } else {
            console.log('‚ùå GA4: gtag function not available');
          }
        } catch (error) {
          console.log('‚ùå GA4: Error -', error.message);
        }
        
        // Test SiteBehaviour  
        try {
          document.dispatchEvent(new CustomEvent('sitebehaviour-analytics-test', {
            detail: {
              test: 'comprehensive_analytics_test',
              timestamp: Date.now(),
              platform: 'sitebehaviour'
            }
          }));
          results.sitebehaviour = true;
          console.log('‚úÖ SiteBehaviour: Test event sent successfully');
        } catch (error) {
          console.log('‚ùå SiteBehaviour: Error -', error.message);
        }
        
        // Test Firebase (if available)
        try {
          if (window.firebaseAnalytics) {
            window.firebaseAnalytics.logEvent('all_analytics_test', {
              platform: 'firebase'
            });
            results.firebase = true;
            console.log('‚úÖ Firebase: Test event sent successfully');
          } else {
            console.log('‚ö†Ô∏è Firebase: Not configured');
          }
        } catch (error) {
          console.log('‚ùå Firebase: Error -', error.message);
        }
        
        // Test CyborgCRM (if available)
        try {
          if (typeof window.CyborgCRM === 'function') {
            CyborgCRM('track', 'all_analytics_test', {
              platform: 'cyborgcrm'
            });
            results.cyborgcrm = true;
            console.log('‚úÖ CyborgCRM: Test event sent successfully');
          } else {
            console.log('‚ö†Ô∏è CyborgCRM: Not configured');
          }
        } catch (error) {
          console.log('‚ùå CyborgCRM: Error -', error.message);
        }
        
        // Summary
        const workingPlatforms = Object.values(results).filter(Boolean).length;
        const totalPlatforms = Object.keys(results).length;
        
        console.log('\nüìä ANALYTICS TEST SUMMARY');
        console.log('========================');
        console.log(`üéØ Working Platforms: ${workingPlatforms}/${totalPlatforms}`);
        
        Object.entries(results).forEach(([platform, working]) => {
          console.log(`  ${working ? '‚úÖ' : '‚ùå'} ${platform}: ${working ? 'WORKING' : 'ISSUES'}`);
        });
        
        if (workingPlatforms > 0) {
          console.log('üéâ Analytics tracking is operational!');
        } else {
          console.log('‚ö†Ô∏è No analytics platforms are working - check implementation');
        }
        
        return results;
      };

      // SiteBehaviour connection test
      function testSiteBehaviourConnection() {
        console.log('üß™ Testing SiteBehaviour data transmission...');
        
        try {
          document.dispatchEvent(new CustomEvent('sitebehaviour-pageview', {
            detail: {
              page: window.location.pathname,
              title: document.title,
              url: window.location.href,
              timestamp: Date.now(),
              test: true
            }
          }));
          console.log('üìä SiteBehaviour test page view event sent');
        } catch (error) {
          console.error('‚ùå Failed to send SiteBehaviour page view:', error);
        }
      }

      // Make test functions globally available
      window.testSiteBehaviourConnection = testSiteBehaviourConnection;
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>