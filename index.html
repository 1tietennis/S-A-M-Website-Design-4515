<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Secret Agent Digital Marketing - Stealth Strategies. Real Results.</title>
    <meta name="description" content="Elite digital marketing agency delivering ROI-driven campaigns for small businesses. Custom strategies, transparent reporting, and proven results." />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Orbitron:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    
    <!-- GOOGLE TAG MANAGER (GTM) - PRIMARY IMPLEMENTATION -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-XXXXXXX');</script>
    <!-- End Google Tag Manager -->
    
    <!-- GOOGLE ANALYTICS 4 (GA4) - DIRECT IMPLEMENTATION -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CTDQQ8XMKC"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CTDQQ8XMKC', {
        page_title: document.title,
        page_location: window.location.href,
        send_page_view: true
      });
      
      // Enhanced initialization logging
      console.log('âœ… Google Analytics 4 (gtag.js) loaded');
      console.log('ğŸ“Š Measurement ID: G-CTDQQ8XMKC');
      console.log('ğŸ¯ DataLayer initialized with gtag function');
      
      // Make gtag globally available for verification
      window.gtagLoaded = true;
    </script>
    
    <!-- GOOGLE ANALYTICS VERIFICATION & TEST SCRIPT -->
    <script>
      // Comprehensive GA4 verification function
      window.verifyGA4Implementation = function() {
        console.log('ğŸ§ª VERIFYING GOOGLE ANALYTICS 4 IMPLEMENTATION');
        console.log('=================================================');
        
        const results = {
          gtagFunction: typeof window.gtag === 'function',
          dataLayer: window.dataLayer && Array.isArray(window.dataLayer),
          scriptTag: !!document.querySelector('script[src*="googletagmanager.com/gtag/js?id=G-CTDQQ8XMKC"]'),
          measurementId: 'G-CTDQQ8XMKC',
          gtagLoaded: window.gtagLoaded === true
        };
        
        console.log('ğŸ“Š Test Results:');
        console.log(' âœ… gtag function:', results.gtagFunction ? 'AVAILABLE' : 'âŒ MISSING');
        console.log(' âœ… dataLayer:', results.dataLayer ? `ACTIVE (${window.dataLayer.length} entries)` : 'âŒ MISSING');
        console.log(' âœ… Script tag:', results.scriptTag ? 'LOADED' : 'âŒ MISSING');
        console.log(' âœ… Measurement ID:', results.measurementId);
        console.log(' âœ… gtag loaded flag:', results.gtagLoaded ? 'TRUE' : 'âŒ FALSE');
        
        // Test event firing
        try {
          gtag('event', 'ga4_verification_test', {
            event_category: 'testing',
            event_label: 'ga4_implementation_check',
            custom_parameter: 'verification_successful',
            timestamp: new Date().toISOString()
          });
          console.log(' âœ… Test event fired successfully');
          results.eventFiring = true;
        } catch (error) {
          console.log(' âŒ Test event failed:', error.message);
          results.eventFiring = false;
        }
        
        // Test page view tracking
        try {
          gtag('config', 'G-CTDQQ8XMKC', {
            page_title: 'Test Page View',
            page_location: window.location.href,
            send_page_view: true
          });
          console.log(' âœ… Page view tracking test successful');
          results.pageViewTracking = true;
        } catch (error) {
          console.log(' âŒ Page view tracking failed:', error.message);
          results.pageViewTracking = false;
        }
        
        const allPassed = Object.values(results).every(val => val === true || typeof val === 'string');
        console.log('\nğŸ¯ Overall Status:', allPassed ? 'âœ… FULLY OPERATIONAL' : 'âš ï¸ ISSUES DETECTED');
        
        if (allPassed) {
          console.log('ğŸ‰ Google Analytics 4 is working perfectly!');
          console.log('ğŸ“Š Data is being sent to GA4 dashboard');
          console.log('ğŸš€ Ready for production tracking');
        } else {
          console.log('âš ï¸ Some issues detected - check failed items above');
        }
        
        return results;
      };
      
      // Auto-verify after page load
      window.addEventListener('load', () => {
        setTimeout(() => {
          console.log('ğŸ” Auto-running GA4 verification...');
          window.verifyGA4Implementation();
        }, 2000);
      });
      
      // Real-time tracking test
      window.testGA4Tracking = function() {
        console.log('ğŸ§ª TESTING GA4 REAL-TIME TRACKING');
        console.log('=================================');
        
        if (typeof gtag === 'function') {
          // Send multiple test events
          const testEvents = [
            { name: 'test_page_view', params: { page_title: 'Test Page', page_location: window.location.href }},
            { name: 'test_button_click', params: { event_category: 'testing', event_label: 'test_button' }},
            { name: 'test_form_interaction', params: { event_category: 'testing', form_name: 'test_form' }},
            { name: 'test_conversion', params: { event_category: 'conversion', value: 1, currency: 'USD' }}
          ];
          
          testEvents.forEach((event, index) => {
            setTimeout(() => {
              gtag('event', event.name, event.params);
              console.log(`ğŸ“Š Sent test event ${index + 1}: ${event.name}`);
            }, index * 1000);
          });
          
          console.log('âœ… All test events queued for sending');
          console.log('ğŸ“ˆ Check GA4 Real-Time reports in 1-2 minutes');
        } else {
          console.error('âŒ gtag function not available');
        }
      };
    </script>
    
    <!-- SITEBEHAVIOUR TRACKING - VERIFIED VERSION -->
    <script type="text/javascript">
      (function() {
        var sbSiteSecret = '507f5743-d0f0-49db-a5f0-0d702b989128';
        window.sitebehaviourTrackingSecret = sbSiteSecret;
        
        var scriptElement = document.createElement('script');
        scriptElement.defer = true;
        scriptElement.id = 'site-behaviour-script-v2';
        scriptElement.src = 'https://sitebehaviour-cdn.fra1.cdn.digitaloceanspaces.com/index.min.js?sitebehaviour-secret=' + sbSiteSecret;
        
        scriptElement.onload = function() {
          console.log('âœ… SiteBehaviour script loaded successfully');
          console.log('ğŸ¯ Secret configured:', sbSiteSecret.substring(0, 8) + '...');
          
          // Test SiteBehaviour connection
          if (typeof window.testSiteBehaviourConnection === 'function') {
            window.testSiteBehaviourConnection();
          }
        };
        
        scriptElement.onerror = function() {
          console.error('âŒ CRITICAL: SiteBehaviour script failed to load');
        };
        
        document.head.appendChild(scriptElement);
        console.log('ğŸš€ SiteBehaviour tracking code initiated');
      })();
    </script>
    
    <!-- COMPREHENSIVE ANALYTICS TEST FUNCTION -->
    <script>
      // Test all analytics platforms together
      window.testAllAnalytics = function() {
        console.log('ğŸ§ª TESTING ALL ANALYTICS PLATFORMS');
        console.log('==================================');
        
        const results = {
          ga4: false,
          sitebehaviour: false,
          dataLayer: false
        };
        
        // Test GA4 (Primary)
        try {
          if (typeof window.gtag === 'function') {
            gtag('event', 'all_analytics_test', {
              event_category: 'testing',
              event_label: 'comprehensive_test',
              platform: 'ga4',
              timestamp: new Date().toISOString()
            });
            results.ga4 = true;
            console.log('âœ… GA4: Test event sent successfully');
          } else {
            console.log('âŒ GA4: gtag function not available');
          }
        } catch (error) {
          console.log('âŒ GA4: Error -', error.message);
        }
        
        // Test DataLayer
        try {
          if (window.dataLayer && Array.isArray(window.dataLayer)) {
            window.dataLayer.push({
              event: 'custom_analytics_test',
              eventCategory: 'testing',
              eventAction: 'dataLayer_test',
              eventLabel: 'comprehensive_test'
            });
            results.dataLayer = true;
            console.log('âœ… DataLayer: Test event pushed successfully');
          } else {
            console.log('âŒ DataLayer: Not available or not an array');
          }
        } catch (error) {
          console.log('âŒ DataLayer: Error -', error.message);
        }
        
        // Test SiteBehaviour
        try {
          document.dispatchEvent(new CustomEvent('sitebehaviour-analytics-test', {
            detail: {
              test: 'comprehensive_analytics_test',
              timestamp: Date.now(),
              platform: 'sitebehaviour'
            }
          }));
          results.sitebehaviour = true;
          console.log('âœ… SiteBehaviour: Test event sent successfully');
        } catch (error) {
          console.log('âŒ SiteBehaviour: Error -', error.message);
        }
        
        // Summary
        const workingPlatforms = Object.values(results).filter(Boolean).length;
        const totalPlatforms = Object.keys(results).length;
        
        console.log('\nğŸ“Š ANALYTICS TEST SUMMARY');
        console.log('========================');
        console.log(`ğŸ¯ Working Platforms: ${workingPlatforms}/${totalPlatforms}`);
        
        Object.entries(results).forEach(([platform, working]) => {
          console.log(` ${working ? 'âœ…' : 'âŒ'} ${platform}: ${working ? 'WORKING' : 'ISSUES'}`);
        });
        
        if (workingPlatforms > 0) {
          console.log('ğŸ‰ Analytics tracking is operational!');
          console.log('ğŸ“Š Run window.testGA4Tracking() for real-time testing');
        } else {
          console.log('âš ï¸ No analytics platforms are working - check implementation');
        }
        
        return results;
      };
      
      // SiteBehaviour connection test
      window.testSiteBehaviourConnection = function() {
        console.log('ğŸ§ª Testing SiteBehaviour data transmission...');
        try {
          document.dispatchEvent(new CustomEvent('sitebehaviour-pageview', {
            detail: {
              page: window.location.pathname,
              title: document.title,
              url: window.location.href,
              timestamp: Date.now(),
              test: true
            }
          }));
          console.log('ğŸ“Š SiteBehaviour test page view event sent');
        } catch (error) {
          console.error('âŒ Failed to send SiteBehaviour page view:', error);
        }
      };
      
      // Make test functions globally available
      window.checkAnalyticsStatus = function() {
        console.log('ğŸ” CHECKING ANALYTICS STATUS');
        console.log('============================');
        console.log('GA4 gtag function:', typeof window.gtag === 'function' ? 'âœ… Available' : 'âŒ Missing');
        console.log('DataLayer:', window.dataLayer && Array.isArray(window.dataLayer) ? `âœ… Active (${window.dataLayer.length} entries)` : 'âŒ Missing');
        console.log('SiteBehaviour secret:', window.sitebehaviourTrackingSecret ? 'âœ… Configured' : 'âŒ Missing');
        console.log('SiteBehaviour script:', document.querySelector('#site-behaviour-script-v2') ? 'âœ… Loaded' : 'âŒ Missing');
        
        console.log('\nğŸ§ª Available test functions:');
        console.log('â€¢ window.verifyGA4Implementation() - Verify GA4 setup');
        console.log('â€¢ window.testGA4Tracking() - Test real-time tracking');
        console.log('â€¢ window.testAllAnalytics() - Test all platforms');
        console.log('â€¢ window.testSiteBehaviourConnection() - Test SiteBehaviour');
      };
    </script>
  </head>
  
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    
    <!-- Analytics Auto-Test on Load -->
    <script>
      // Auto-run analytics check after page fully loads
      window.addEventListener('load', () => {
        setTimeout(() => {
          console.log('ğŸš€ Auto-running analytics status check...');
          if (typeof window.checkAnalyticsStatus === 'function') {
            window.checkAnalyticsStatus();
          }
        }, 3000);
      });
    </script>
  </body>
</html>